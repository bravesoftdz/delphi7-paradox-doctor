%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Database Doctor
% LaTeX Version
% v1.0.0 (02/02/22)
%
% Original author:
% Lucas Rodrigues (lucas@cervellesoftware.com)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------
\documentclass[a4paper, 11pt]{article} 

\usepackage[utopia]{mathdesign}
\usepackage[svgnames]{xcolor} 
\usepackage[utf8]{inputenc} 
\usepackage[T1]{fontenc} 
\usepackage{PTSerif} 
\usepackage{listings}
\usepackage{graphicx}
\usepackage{fancyhdr}
\usepackage{lastpage}
\usepackage{xcolor}
\usepackage[english]{babel}

\graphicspath{ {./img/} }

\begin{document} 

%----------------------------------------------------------------------------------------
%	TITLE PAGE
%----------------------------------------------------------------------------------------

\begin{titlepage} % Suppresses headers and footers on the title page

	\raggedleft % Right align everything
	
	\vspace*{\baselineskip} % Whitespace at the top of the page
	
	%------------------------------------------------
	%	Author
	%------------------------------------------------
	\includegraphics[scale=0.6]{cervelle} % Author name
	
	\vspace*{0.2\textheight} % Whitespace before the title
	
	%------------------------------------------------
	%	Title and subtitle
	%------------------------------------------------
	
	\textbf{\LARGE The Complete Guide}\\[\baselineskip] % First title line
	
	{\textcolor{Black}{\Huge Database Doctor v1.0.0}}\\[\baselineskip] % Main title line which draws the focus of the reader
	
	{\Large \textit{Ultimate Merchant Magic\textsuperscript{\textregistered} Paradox Upgrader}} % Subtitle
	
	\vfill % Whitespace between the titles and the publisher
	
	%------------------------------------------------
	%	Publisher
	%------------------------------------------------
	
	{\large Lucas Rodrigues}\\[\baselineskip]{\large Alexander Nikoloff}  % Publisher and logo
	
	\vspace*{3\baselineskip} % Whitespace at the bottom of the page

\end{titlepage}
\pagebreak

%----------------------------------------------------------------------------------------
%	DOCUMENT SETUP
%----------------------------------------------------------------------------------------
\pagestyle{fancy}
\fancyhf{}
\rhead{\copyright 2022 Cervelle Software}
\lhead{Database Doctor v1.0.0}
\rfoot{Page \thepage \hspace{1pt} of \pageref{LastPage}}

%----------------------------------------------------------------------------------------
%	DOCUMENT BODY
%----------------------------------------------------------------------------------------

\section*{Introduction}
This document is intended to be used by Merchant Magic\textsuperscript{\textregistered} software administrators, developers, and others experienced in working with the database update process. This manual provides information on how to use Database Doctor to perform Merchant Magic\textsuperscript{\textregistered} updates for clients utilizing older versions of the software. 

\section*{The Database Doctor}

\section{Overview}
Database Doctor v1.0.0 is an easy-to-use and lightweight generic software, which helps you update clients to the latest version of Merchant Magic\textsuperscript{\textregistered}. By using a generic and clean database, the software not only rebuilds all the indexes, but also makes any pertaining field changes to match the updated paradox tables, including default values. 

\begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{capture 27}
    \caption{Database Doctor v1.0.0 Main Screen}
\end{figure}

\section{Preparation For Database Update}

Please follow the instructions below to complete the preparation process for the Merchant Magic\textsuperscript{\textregistered} update. We have highlighted the items that are most commonly overlooked to help you successfully perform the update. \\

\noindent\rule{\textwidth}{0.5pt}\\

$\bullet$ Once you have your Database Doctor v1.0.0.zip file, place it on your Desktop folder. The folder you decide to place the zip file does not matter. It can be placed anywhere in your computer.

\begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{capture 1}
    \caption{Database Doctor v1.0.0.zip file in Desktop}
\end{figure}

\pagebreak

\vspace*{\fill}
$\bullet$ Now we need to unzip this folder. For that, click on the folder and right-click again to open the menu. Once the menu is opened, select Extract All.

\begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{capture 2}
    \caption{Selecting Extract All in the menu}
\end{figure}
\vspace*{\fill}

\pagebreak

\vspace*{\fill}
$\bullet$ Select the folder where you want to extract your file. In this case we are extracting in the Desktop folder. It is highly suggested that you extract in the same folder you placed the Database Doctor v1.0.0.zip file.

\begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{capture 3}
    \caption{Choosing extraction destination}
\end{figure}
\vspace*{\fill}

\pagebreak

\vspace*{\fill}
$\bullet$ Wait until the extraction process is completed. That will prompt the folder with the files needed for the Merchant Magic\textsuperscript{\textregistered} update.

\begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{capture 4}
    \caption{Copying files to destination folder...}
\end{figure}
\vspace*{\fill}

\pagebreak

\vspace*{\fill}
$\bullet$ Now that the file is fully unzipped, let's go ahead and open the folder. You should notice the following directory:

\begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{capture 5}\\
     \includegraphics[width=\textwidth]{capture 6}
    \caption{Unzipped Database Doctor v1.0.0 directory}
\end{figure}
\vspace*{\fill}

\pagebreak

\vspace*{\fill}
\colorbox{yellow}{ PLEASE DO NOT USE MERCHANT MAGIC WHILE UPDATING!}\\\\
$\bullet$ You are now ready to begin! On the \colorbox{yellow}{client's station}, navigate in File Explorer to their DB. It should be under C://Program Files(x86)/Merchant Magic. Once you find their DB folder, compress it.

\begin{figure}[h]
    \centering
     \includegraphics[width=\textwidth]{capture 7}
    \caption{Compressing client's DB folder}
\end{figure}
PS: Note that if the DB folder is not located in the Merchant Magic\textsuperscript{\textregistered} folder, refer to the Registry Editor or BDE to find DB path. If that still does not work, check the shares of the computer to find the shared DB folder. 
\vspace*{\fill}

\pagebreak

\vspace*{\fill}
$\bullet$ Now that you have the zipped DB from the client's station, transfer that over your computer through SimpleHelp.

\begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{capture 8}
    \caption{Compressed DB in \colorbox{yellow}{client's station} ready to be transferred}
\end{figure}
\vspace*{\fill}

\pagebreak

\vspace*{\fill}
$\bullet$ On \colorbox{yellow}{your station}, rename the file for better organization and tracking of actions, in case we start updating, and something happens. After that, open the compressed folder to see the contents.

\begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{capture 10}
    \caption{Open renamed DB folder in \colorbox{yellow}{your station}  (Gun Range DB)}
\end{figure}
\vspace*{\fill}

\pagebreak

\vspace*{\fill}
$\bullet$ Press the keyboard shortcut Ctrl+A to select all items in the folder, then right-click on any item and press copy as it shows in the picture.

\begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{capture 11}
    \caption{Copying all items from client's database}
\end{figure}
\vspace*{\fill}

\pagebreak

\vspace*{\fill}
$\bullet$ Now that you copied all items. Navigate to \colorbox{yellow}{your} Merchant Magic\textsuperscript{\textregistered} folder and place all items in the DB folder. Reference path: C://Program Files(x86)/Merchant Magic/DB

\begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{capture 12}
    \caption{Pasting all items in Merchant Magic\textsuperscript{\textregistered} folder}
\end{figure}
\vspace*{\fill}

\pagebreak

\vspace*{\fill}
$\bullet$ Once you have the client's DB in your Merchant Magic\textsuperscript{\textregistered} folder, we need to make sure your Alias is set up right. So, the first thing to do is to navigate to your bdeadmin.exe in C:/Program Files(x86)/Common Files/Borland Shared/BDE

\begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{capture 13}
    \caption{Finding bdeadmin.exe in BDE folder}
\end{figure}
\vspace*{\fill}

\pagebreak

\vspace*{\fill}
$\bullet$ Right-click on the application and "Run as administrator"

\begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{capture 14}
    \caption{Run bdeadmin.exe as administrator}
\end{figure}
\vspace*{\fill}

\pagebreak

\vspace*{\fill}
$\bullet$ Make sure the path for the Merchant Magic alias is set up to C:/Program Files(x86)/Merchant Magic/DB

\begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{capture 15}
    \caption{Set up Merchant Magic alias}
\end{figure}
\vspace*{\fill}

\pagebreak

\vspace*{\fill}
$\bullet$ Now that we know our Alias is set up right in bdeadmin.exe, let's navigate to the Registry Editor and do the same.

\begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{capture 17}
    \caption{Registry set up}
\end{figure}
\vspace*{\fill}

\pagebreak

\section{Database Update}
\colorbox{yellow}{ONCE AGAIN, DO NOT USE MERCHANT MAGIC WHILE UPDATING!}\\\\
$\bullet$ You are ready for the update! Go back to your Database Doctor v1.0.0 folder. The first thing we need to do before running the HelixDoctor is to fix any corrupted data that could cause the update to fail. For that, let's open the IndexFixer folder and run Pdxbld.exe as administrator.

\begin{figure}[h]
    \centering
    \includegraphics[width=\textwidth]{capture 18}
     \includegraphics[width=\textwidth]{capture 19}
    \caption{Opening the IndexFixer folder and running Pdxbld.exe as administrator}
\end{figure}

\pagebreak

\vspace*{\fill}
$\bullet$ Once you have Pdxbld.exe open, make sure all set up matches the image below. We need to index fix all the tables prior to run HelixDoctor.exe.

\begin{figure}[h]
    \centering
     \includegraphics[width=\textwidth]{capture 20}
    \caption{Getting ready to run index fixer}
\end{figure}
\vspace*{\fill}

\pagebreak

\vspace*{\fill}
$\bullet$ Press Start to begin fixing the indexes.

\begin{figure}[h]
    \centering
     \includegraphics[width=\textwidth]{capture 21}
    \caption{Starting the Index Fixer}
\end{figure}
\vspace*{\fill}

\pagebreak

\vspace*{\fill}
$\bullet$ Once the index fixer stops, check if there are any errors. If yes, check if they were fixed. If no errors were encountered, move on to the next step.

\begin{figure}[h]
    \centering
     \includegraphics[width=\textwidth]{capture 22}
    \caption{View the errors}
\end{figure}
\vspace*{\fill}

\pagebreak

\vspace*{\fill}
$\bullet$ Now we are finally ready for HelixDoctor.exe. Go back to the Database Doctor v1.0.0 folder and right-click on the application and Run as administrator.
\begin{figure}[h]
    \centering
     \includegraphics[width=\textwidth]{capture 24}
    \caption{Running HelixDoctor.exe as administrator}
\end{figure}
\vspace*{\fill}

\pagebreak

\vspace*{\fill}
$\bullet$ Once application is opened, press the option Database from the top menu and select Rebuild. That will go over all tables and make sure all headers are correct and transposed to Paradox 7.
\begin{figure}[h]
    \centering
     \includegraphics[width=\textwidth]{capture 25}
    \caption{Rebuilding all tables...}
\end{figure}
\vspace*{\fill}

\pagebreak

\vspace*{\fill}
$\bullet$ Please note that the application is running. It is normal to have a (Not Responding) label on screen. \colorbox{Red}{\textcolor{White}{DO NOT EXIT APPLICATION}} while it is running. Wait until Rebuild process is done. 
\begin{figure}[h]
    \centering
     \includegraphics[width=\textwidth]{capture 27}
    \caption{Not responding!! }
\end{figure}
\vspace*{\fill}

\pagebreak

\vspace*{\fill}
$\bullet$ Please note that it is also \textbf{normal}  to get this error. This means that you have a table with .DBF extension. That does not affect the update. If this error appears, press OK and move on.
\begin{figure}[h]
    \centering
     \includegraphics[width=\textwidth]{capture 28}
    \caption{DBF Paradox Error}
\end{figure}
\vspace*{\fill}

\pagebreak

\vspace*{\fill}
$\bullet$ Now that you are done rebuilding all the tables, it is time to update. In the Database menu on top, click on Upgrade. That should go over each table in the Database and check if table exists, modify the existing tables, add new tables, add new fields, set up default values, and also destroys all indexes and re-creates all of them. 
\begin{figure}[h]
    \centering
     \includegraphics[width=\textwidth]{capture 29}
    \caption{Upgrading Database...}
\end{figure}
\vspace*{\fill}

\pagebreak

\vspace*{\fill}
$\bullet$ Once the upgrade starts, please note that the progress bar not only shows the progress but it shows exactly which field the application is working on live time. On the left side you can also notice that tables that did not get upgraded are still selected once upgrader goes over it. \\\\
That means that they were not update, could be because table does not exist in clean DB, or table was corrupted and could not be opened. Once this process is over, \colorbox{Green}{\textcolor{White}{UPDATE IS COMPLETE ! ! !}}
\begin{figure}[h]
    \centering
     \includegraphics[width=\textwidth]{capture 30}
    \caption{Upgrading Database...}
\end{figure}
\vspace*{\fill}

\pagebreak

\vspace*{\fill}
$\bullet$ Now, let's suppose you are updating a client from 2021, and you know that you just need to update his customer.db table. Not a problem, with Database Doctor you can also update selected tables only. Make sure you have all tables unchecked apart from the table you want to update. On the menu press Table, then Rebuild Selected Tables.
\begin{figure}[h]
    \centering
     \includegraphics[width=\textwidth]{capture 34}
    \caption{Rebuild only selected tables}
\end{figure}
\vspace*{\fill}

\pagebreak

\vspace*{\fill}
$\bullet$ After you rebuild only selected tables, go back to the menu and press Table to select Upgrade Selected Tables, that would perform the update only for selected tables. 
\begin{figure}[h]
    \centering
     \includegraphics[width=\textwidth]{capture 36}
    \caption{Update only selected tables}
\end{figure}
\vspace*{\fill}

\pagebreak

\vspace*{\fill}
$\bullet$ Once you are done the update, you can exit the application. For that, you can use either the X button on top-right or go to File in the menu and press Exit.
\begin{figure}[h]
    \centering
     \includegraphics[width=\textwidth]{capture 38}
    \caption{Update is complete. Exit the application.}
\end{figure}
\vspace*{\fill}

\pagebreak

\vspace*{\fill}
$\bullet$ Now that the update is done, it is ideal to run the index fixer again to verify that the updater did not corrupt any table, and all tables got closed correctly.
\begin{figure}[h]
    \centering
     \includegraphics[width=\textwidth]{capture 40}
    \caption{Index Fixer with no errors after update}
\end{figure}
\vspace*{\fill}

\pagebreak

\vspace*{\fill}
$\bullet$ Once the index fixer is done, we are ready to send the DB back. Navigate to \colorbox{yellow}{your} Merchant Magic\textsuperscript{\textregistered} folder and compress your "updated" DB folder. Reference path: C://Program Files(x86)/Merchant Magic.
\begin{figure}[h]
    \centering
     \includegraphics[width=\textwidth]{capture 41}
    \caption{Compressing updated DB folder}
\end{figure}
\vspace*{\fill}

\pagebreak

\vspace*{\fill}
$\bullet$ Now that you have your updated DB folder, rename that to Post Update, that way we have the version before update, and after update as it shows. Once you do that, go to the \colorbox{yellow}{client's station} and replace their DB folder with your PostUpdate folder. 
\begin{figure}[h]
    \centering
     \includegraphics[width=\textwidth]{capture 42}
    \caption{Renaming updated DB folder}
\end{figure}
\vspace*{\fill}

\pagebreak

%----------------------------------------------------------------------------------------
%	COPYRIGHT
%----------------------------------------------------------------------------------------
\section{Additional Tools}
$\bullet$ You can select any table from the select box on the left and see the differences between the client's table and the clean DB.
\begin{figure}[h]
    \centering
     \includegraphics[width=\textwidth]{capture 31}
    \caption{Table stats and informations}
\end{figure}

\pagebreak

\vspace*{\fill}
$\bullet$ You can select the "Index" tab and see the indexes from both client's table and the clean DB.
\begin{figure}[h]
    \centering
     \includegraphics[width=\textwidth]{capture 32}
    \caption{Indexes}
\end{figure}
\vspace*{\fill}
\pagebreak

\vspace*{\fill}
$\bullet$ You can select the "Fields" tab and see the field differences from both client's table and the clean DB.
\begin{figure}[h]
    \centering
     \includegraphics[width=\textwidth]{capture 33}
    \caption{Fields}
\end{figure}
\vspace*{\fill}
\pagebreak

\vspace*{\fill}
$\bullet$ You can select the "SQL" tab and create any SQL query to navigate into the Database. Please note that this tool is really dangerous. DO NOT USE DELETE SQL QUERY in this box. Once you delete something in the table, it will \colorbox{Red}{\textcolor{White}{NEVER}} be recovered.\\ \\
\begin{figure}[h]
    \centering
     \includegraphics[width=\textwidth]{capture 43}
    \caption{Empty SQL field box}
\end{figure}
\vspace*{\fill}
\colorbox{Red}{\textcolor{White}{CAUTION! DO NOT...EVER....USE THE DELETE SQL QUERY HERE}} 
\pagebreak

\vspace*{\fill}
$\bullet$ Once you press "Execute", the SQL emits the result in the console under the box.
\begin{figure}[h]
    \centering
     \includegraphics[width=\textwidth]{capture 44}
    \caption{SQL Query input, execute, and result}
\end{figure}
\vspace*{\fill}
\pagebreak

\vspace*{\fill}
$\bullet$ Once you press "Clear", the SQL box is cleared to receive another query input.
\begin{figure}[h]
    \centering
     \includegraphics[width=\textwidth]{capture 45}
    \caption{SQL Query clear}
\end{figure}
\vspace*{\fill}

%\section{How to Update SELECTED Database}
%\section{Frequent Asked Questions}
%\section*{Conclusion}

\pagebreak

%----------------------------------------------------------------------------------------
%	COPYRIGHT
%----------------------------------------------------------------------------------------
\section*{Copyright Information}
\textbf{Copyright \copyright 2022 Cervelle Software. } \\
All Rights Reserved. Publications can be obtained from Cervelle Software, 6966 Aloma Ave, Winter Park, FL 32792, United States (tel.: +407-673-4898; e-mail: lucas@cervellesoftware.com). Requests for permission to reproduce or translate Cervelle Software publications – whether for sale or for noncommercial  distribution – should be addressed to Nathalie Day, at the above address (tel.:  +407-673-4898; e-mail: nat@cervellesoftware.com). \\

The specifications and information regarding the products in this manual are subject to change without notice. All statements, information, and recommendations in this manual are believed to be accurate but are presented without warranty of any kind, express or implied. Users must take full responsibility for their application of any products.\\

Notwithstanding any other warranty herein, all document files and software of Cervelle Software are provided as is with all faults. Cervelle disclaim all warranties, expressed or implied, including, without limitation, those of merchantability, fitness for a particular purpose and non-infringement or arising from a course of dealing, usage, or trade practice.\\

In no event shall Cervelle Software be liable for any indirect, special, consequential, or incidental damages, including, without limitation, lost profits or loss or damage to data arising out of the use or inabilty to use this manual, even if cisco or its suppliers have been advised of the possibility of such damages.
\end{document}

%----------------------------------------------------------------------------------------
%	END
%----------------------------------------------------------------------------------------